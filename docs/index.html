<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Sebastián Sánchez Cuartas" />


<title>Algoritmo de R para el Análisis de Conectividad Histórica de Linajes de Páramo en el Pleistoceno</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Algoritmo de R para el Análisis de
Conectividad Histórica de Linajes de Páramo en el Pleistoceno</h1>
<h4 class="author">Sebastián Sánchez Cuartas</h4>
<h4 class="date">agosto 21, 2024</h4>

</div>


<div id="introducción" class="section level1">
<h1><strong>Introducción</strong></h1>
<p>El siguiente algoritmo fue diseñado para calcular la conectividad
histórica entre pares de linajes, con el objetivo de analizar la
relación entre esta conectividad y las distancias evolutivas entre
ellos. Para lograrlo, se utilizan los tiempos correspondientes al
intervalo entre nodos padre e hijo para todos los pares posibles en un
árbol ultramétrico (véase Figura 1, ejemplo: tiempo entre los nodos 8 y
9). Estos tiempos representan, hipotéticamente, los eventos que llevaron
a la divergencia entre linajes, en contextos como las fluctuaciones
climáticas del Pleistoceno, las cuales influyeron en los períodos de
mayor o menor conectividad, resultando en la divergencia.</p>
<p>El algoritmo también utiliza una base de datos de la columna de polen
estudiada en <em>Flantua et al.</em> (2019), que abarca <strong>1,645
instantes en el tiempo</strong>. Cada uno de estos instantes refleja una
configuración de páramo específica y su duración en millones de años. A
partir de esta base de datos, el algoritmo extrae las configuraciones de
páramo y sus duraciones correspondientes a los intervalos de tiempo
entre nodos padre e hijo. Luego, incorpora los índices de conectividad
precalculados (<strong>Dist, DistM y CF</strong>. Estos tres índices se
emplean en el análisis de conectividad, donde Dist evalúa la ruta de
menor costo, mientras que CF considera todas las rutas potenciales en
términos de corriente eléctrica.) (ver Figura 2) para estas
configuraciones, ponderando cada configuración por su duración.</p>
<p>De esta manera, se obtiene un valor único, el cual es un promedio
ponderado que representa la conectividad histórica durante el intervalo
de tiempo entre los nodos padre e hijo. Este valor tiene el objetivo de
resaltar la influencia de las diferentes estructuras de páramo en la
divergencia evolutiva de los linajes, proporcionando una medida
integrada de la conectividad histórica basada en las condiciones
paleoclimáticas y la dinámica hipotética de los páramos.</p>
<p>Para ilustrar esta metodología, se presenta un ejemplo hipotético que
se aplica de manera similar a todas las combinaciones posibles de pares
de terminales en una filogenia. Consideremos el par de especies B y E de
la Figura 1. El algoritmo primero identifica el tiempo de divergencia
entre B y E, correspondiente al nodo 9, que ocurre aproximadamente a
<strong>0.22 millones de años (Ma)</strong>. A continuación, determina
el tiempo del nodo padre correspondiente al nodo 9, que es
aproximadamente <strong>0.5 Ma</strong>.</p>
<p>Con estos datos, el algoritmo consulta la base de datos de la columna
de polen de <em>Flantua et al.</em> (2019) para seleccionar el rango
temporal correspondiente al intervalo entre los nodos 8 y 9. Durante
este rango de tiempo, se presentan diversas configuraciones
altitudinales del páramo, cada una con su duración respectiva.
Utilizando estos datos, se procede a calcular la conectividad histórica
media ponderada (<strong>CMP</strong>), como se ejemplifica a
continuación:</p>
<ol style="list-style-type: decimal">
<li><p>Supongamos que las configuraciones altitudinales para el rango
temporal entre los nodos 8 y 9 son <strong>2700, 2800 y 3200 metros
sobre el nivel del mar (msnm)</strong>, con duraciones respectivas
<strong>α, β y γ</strong>.</p></li>
<li><p>Los índices de conectividad preelaborados para estas
configuraciones son <strong>Dist2700, Dist2800 y Dist3200</strong> para
el índice <strong>Dist</strong>. De manera similar, se disponen de
índices para <strong>DistM</strong> y <strong>CF</strong>. Estos tres
índices se emplean en el análisis de conectividad, donde
<strong>Dist</strong> evalúa la ruta de menor costo, mientras que
<strong>CF</strong> considera todas las rutas potenciales en términos de
corriente eléctrica.</p></li>
<li><p>La conectividad histórica media ponderada (<strong>CMP</strong>)
para el índice <strong>Dist</strong> se calcula de la siguiente
manera:</p></li>
</ol>
<p>…</p>
<p><span class="math display">\[
\text{CMP-Dist} = \frac{(\alpha \cdot \text{Dist2700} + \beta \cdot
\text{Dist2800} + \gamma \cdot \text{Dist3200})}{\alpha + \beta +
\gamma}
\]</span></p>
<p>…</p>
<p>Este mismo procedimiento se repite para los otros índices,
<strong>DistM</strong> y <strong>CF</strong>, resultando en los valores
<strong>CMP-Dist</strong>, <strong>CMP-DistM</strong> y
<strong>CMP-CF</strong>. Estos valores sintetizan la conectividad
histórica entre el par específico de organismos B y E durante el periodo
de tiempo considerado.</p>
<p>…</p>
<div class="figure" style="text-align: center">
<img src="Ejemplo_B&E.jpg" alt="**Figura 1.** *Ejemplo de filogenia con referencia a tiempo ultramétrico.* La filogenia muestra la relación evolutiva entre las especies A, B, C, D y E (indicadas numéricamente en naranja), donde cada nodo numérico (en verde) representa un ancestro común. La barra de tiempo debajo de la filogenia ofrece una referencia visual del tiempo ultramétrico en millones de años para todo el árbol. Las líneas rojas representan un caso hipotético de estudio entre el par B y E. En este ejemplo, se estudia el periodo de tiempo entre los nodos 8 y 9, indicado por una línea purpura, donde se ilustran las fluctuaciones climáticas del Pleistoceno. Este esquema ejemplifica el cálculo de los tiempos de divergencia entre nodos, como se describe en la metodología del estudio." width="90%" />
<p class="caption">
<strong>Figura 1.</strong> <em>Ejemplo de filogenia con referencia a
tiempo ultramétrico.</em> La filogenia muestra la relación evolutiva
entre las especies A, B, C, D y E (indicadas numéricamente en naranja),
donde cada nodo numérico (en verde) representa un ancestro común. La
barra de tiempo debajo de la filogenia ofrece una referencia visual del
tiempo ultramétrico en millones de años para todo el árbol. Las líneas
rojas representan un caso hipotético de estudio entre el par B y E. En
este ejemplo, se estudia el periodo de tiempo entre los nodos 8 y 9,
indicado por una línea purpura, donde se ilustran las fluctuaciones
climáticas del Pleistoceno. Este esquema ejemplifica el cálculo de los
tiempos de divergencia entre nodos, como se describe en la metodología
del estudio.
</p>
</div>
<p>…</p>
<div class="figure" style="text-align: center">
<img src="Indices_precalculados.gif" alt="**Figura 2.** *Configuraciones de páramos basadas en el estudio de Flantua et al. (2019).* Este GIF muestra todas las posibles configuraciones de páramos en el modelo de Flantua et al. (2019). En la parte inferior se indican los rangos de páramo que representa cada imagen. El ejemplo incluye la cordillera oriental, donde los puntos rojos indican las ubicaciones de las muestras de frailejones. Las líneas blancas representan únicamente los índices Dist y DistM, excluyendo el índice CF. Los índices Dist y DistM reflejan la distancia de menor costo en unidades de costo y en metros, respectivamente. Los colores en el GIF representan los costos al movimiento: las tonalidades verdes indican menor costo, mientras que las tonalidades grises reflejan mayores costos. Es importante destacar que este GIF no representa una secuencia temporal. En lugar de mostrar cómo evolucionaron los páramos del pasado al presente, ilustra las configuraciones de páramo durante las fluctuaciones climáticas del Pleistoceno, las cuales ocurrieron en diferentes momentos y no en un orden fijo." width="57%" />
<p class="caption">
<strong>Figura 2.</strong> <em>Configuraciones de páramos basadas en el
estudio de Flantua et al. (2019).</em> Este GIF muestra todas las
posibles configuraciones de páramos en el modelo de Flantua et
al. (2019). En la parte inferior se indican los rangos de páramo que
representa cada imagen. El ejemplo incluye la cordillera oriental, donde
los puntos rojos indican las ubicaciones de las muestras de frailejones.
Las líneas blancas representan únicamente los índices Dist y DistM,
excluyendo el índice CF. Los índices Dist y DistM reflejan la distancia
de menor costo en unidades de costo y en metros, respectivamente. Los
colores en el GIF representan los costos al movimiento: las tonalidades
verdes indican menor costo, mientras que las tonalidades grises reflejan
mayores costos. Es importante destacar que este GIF no representa una
secuencia temporal. En lugar de mostrar cómo evolucionaron los páramos
del pasado al presente, ilustra las configuraciones de páramo durante
las fluctuaciones climáticas del Pleistoceno, las cuales ocurrieron en
diferentes momentos y no en un orden fijo.
</p>
</div>
<p>…</p>
</div>
<div id="algoritmo-empleado" class="section level1">
<h1><strong>Algoritmo empleado</strong></h1>
<div id="section" class="section level5">
<h5></h5>
<p><em>Al final, se presenta el resultado para un par de organismos o
parches, incluyendo los mensajes impresos de cada paso del proceso de
ejecución.</em></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer los datos de duración y las configuraciones de páramo del estudio de Flantua et al. (2019)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>datos_duracion <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;C:/Users/Usuario/Desktop/Archivos_tesis/Matrices_UFL/UFL_duration.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer la matriz con los tiempos de los nodos padre del árbol ultramétrico</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>matriz_limites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;C:/Users/Usuario/Desktop/Archivos_tesis/Padre-Hijo_Tiempo/Padre-hijo_Clado_Colombiano - copia.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer la matriz con los tiempos de los nodos hijo del árbol ultramétrico</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>matriz_tiempos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;C:/Users/Usuario/Desktop/Archivos_tesis/Tiempos_divergencia/Tiempos_divergencia_Clado_Colombiano - copia.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################################</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Se define una función para encontrar el valor más cercano en la columna &quot;Age&quot;. Esto es necesario porque los tiempos estudiados entre el nodo padre e hijo no siempre coinciden exactamente con los tiempos disponibles en esta columna. Por lo tanto, la función busca el valor más cercano como punto de partida.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>encontrar_valor_cercano <span class="ot">&lt;-</span> <span class="cf">function</span>(valor, columna) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  valor_cercano <span class="ot">&lt;-</span> columna[<span class="fu">which.min</span>(<span class="fu">abs</span>(columna <span class="sc">-</span> valor))]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(valor_cercano)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicializar un marco de datos para almacenar los resultados finales</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>resultados_finales <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID1 =</span> <span class="fu">character</span>(), <span class="at">ID2 =</span> <span class="fu">character</span>(), <span class="at">Dist =</span> <span class="fu">numeric</span>(), <span class="at">DistM =</span> <span class="fu">numeric</span>(), <span class="at">CF_beta0_graph1 =</span> <span class="fu">numeric</span>(), <span class="at">CF_beta1_graph1 =</span> <span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterar sobre cada par de IDs</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(matriz_tiempos) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(matriz_tiempos)) {  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obtener el par de IDs actual</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    ID1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(matriz_tiempos)[i]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    ID2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(matriz_tiempos)[j]</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcular el tiempo de divergencia entre los pares de IDs</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    valor_tiempo <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(matriz_tiempos[i, j])</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar si el valor de tiempo es numérico y no está en la diagonal principal</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(valor_tiempo) <span class="sc">&amp;&amp;</span> valor_tiempo <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Procesando IDs:&quot;</span>, ID1, <span class="st">&quot;-&quot;</span>, ID2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Valor de tiempo de nodo hijo:&quot;</span>, valor_tiempo, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Buscar el valor más cercano en la columna &quot;Age&quot;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>      valor_cercano_inicio <span class="ot">&lt;-</span> <span class="fu">encontrar_valor_cercano</span>(valor_tiempo, datos_duracion<span class="sc">$</span>Age)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Valor más cercano en la columna &#39;Age&#39; para el inicio de la suma de las columnas de las duraciones en MA para cada configuración de páramo:&quot;</span>, valor_cercano_inicio, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtener el límite de la suma desde matriz_limites</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      limite_suma <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(matriz_limites[i, j])  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Límite hasta donde debe sumar las columnas obtenido desde matriz_limites:&quot;</span>, limite_suma, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Buscar el valor más cercano en la columna &quot;Age&quot; para el límite de la suma</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>      valor_cercano_fin <span class="ot">&lt;-</span> <span class="fu">encontrar_valor_cercano</span>(limite_suma, datos_duracion<span class="sc">$</span>Age)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Valor más cercano en la columna &#39;Age&#39; para el fin de la suma:&quot;</span>, valor_cercano_fin, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular la suma de los valores desde el inicio hasta el límite especificado en matriz_limites</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>      indice_fila_inicio <span class="ot">&lt;-</span> <span class="fu">which</span>(datos_duracion<span class="sc">$</span>Age <span class="sc">==</span> valor_cercano_inicio)[<span class="dv">1</span>]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>      indice_fila_fin <span class="ot">&lt;-</span> <span class="fu">which</span>(datos_duracion<span class="sc">$</span>Age <span class="sc">==</span> valor_cercano_fin)[<span class="dv">1</span>]</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>      suma_valores <span class="ot">&lt;-</span> <span class="fu">colSums</span>(datos_duracion[indice_fila_inicio<span class="sc">:</span>indice_fila_fin, <span class="dv">7</span><span class="sc">:</span><span class="dv">28</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Suma de los valores de las duraciones de las configuraciones de páramo desde el inicio hasta el límite especificado en matriz_limites:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(suma_valores)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Identificar los totales que son mayores que cero</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>      totales_positivos <span class="ot">&lt;-</span> suma_valores[suma_valores <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Totales positivos:&quot;</span>, totales_positivos, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtener los números de los encabezados de las columnas con valores mayores que cero. </span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Esto se realiza porque los archivos de los índices de conectividad precalculados tienen nombres que comienzan con un número específico seguido en el nombre con la configuración de páramo que representa. </span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Este prefijo numérico representa una configuración de páramo particular, la cual se utiliza como base para buscar los índices de conectividad específicos correspondientes a cada configuración en estos archivos.</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>      indices_columnas <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(totales_positivos)))</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Numeros correspondientes de los encabezados de las columnas con valores mayores que cero:&quot;</span>, indices_columnas, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtener los prefijos númericos extraidos del paso anterior</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>      archivos_indices_nombres <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;^(&quot;</span>, <span class="fu">paste</span>(indices_columnas, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>), <span class="st">&quot;_)&quot;</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filtrar los archivos correspondientes a los prefijos númericos en la carpeta de resultados</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>      archivos_indices <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&quot;C:/Users/Usuario/Desktop/Archivos_tesis/Graphab_resultados/Resultados_lmetrics&quot;</span>, </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">pattern =</span> archivos_indices_nombres, </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Ordenar los archivos según los números obtenidos, de esta forma, se asegura que los calculos siguientes se realicen en el mismo orden anterior sobre los archivos extraidos</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>      archivos_indices <span class="ot">&lt;-</span> archivos_indices[<span class="fu">order</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;.*/(</span><span class="sc">\\</span><span class="st">d+)_.*&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, archivos_indices)))]</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Inicializar vectores para almacenar sumas ponderadas (conectividad historica)</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>      suma_ponderada_Dist <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>      suma_ponderada_DistM <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>      suma_ponderada_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>      suma_ponderada_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Iterar sobre los archivos correspondientes</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_along</span>(archivos_indices)) {</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Leer el archivo</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        datos_archivo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(archivos_indices[k], <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar los datos para el par de IDs actual (en ambos órdenes)</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        datos_filtrados_1 <span class="ot">&lt;-</span> datos_archivo[datos_archivo<span class="sc">$</span>ID1 <span class="sc">==</span> ID1 <span class="sc">&amp;</span> datos_archivo<span class="sc">$</span>ID2 <span class="sc">==</span> ID2, ]</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        datos_filtrados_2 <span class="ot">&lt;-</span> datos_archivo[datos_archivo<span class="sc">$</span>ID1 <span class="sc">==</span> ID2 <span class="sc">&amp;</span> datos_archivo<span class="sc">$</span>ID2 <span class="sc">==</span> ID1, ]</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar si hay datos filtrados</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">nrow</span>(datos_filtrados_1) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Calcular las sumas ponderadas</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>          suma_Dist <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_1<span class="sc">$</span>Dist) </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>          suma_DistM <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_1<span class="sc">$</span>DistM) </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>          suma_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_1<span class="sc">$</span>CF_beta0_graph1) </span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>          suma_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_1<span class="sc">$</span>CF_beta1_graph1) </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_Dist <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_Dist, suma_Dist <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_DistM <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_DistM, suma_DistM <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_CF_beta0_graph1, suma_CF_beta0_graph1 <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_CF_beta1_graph1, suma_CF_beta1_graph1 <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">nrow</span>(datos_filtrados_2) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Calcular las sumas ponderadas</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>          suma_Dist <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_2<span class="sc">$</span>Dist) </span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>          suma_DistM <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_2<span class="sc">$</span>DistM) </span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>          suma_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_2<span class="sc">$</span>CF_beta0_graph1) </span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>          suma_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(datos_filtrados_2<span class="sc">$</span>CF_beta1_graph1) </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_Dist <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_Dist, suma_Dist <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_DistM <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_DistM, suma_DistM <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_CF_beta0_graph1, suma_CF_beta0_graph1 <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>          suma_ponderada_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">c</span>(suma_ponderada_CF_beta1_graph1, suma_CF_beta1_graph1 <span class="sc">*</span> totales_positivos[k])</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Imprimir sumas ponderadas finales</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;Sumas ponderadas finales:&quot;</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(suma_ponderada_Dist)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(suma_ponderada_DistM)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(suma_ponderada_CF_beta0_graph1)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(suma_ponderada_CF_beta1_graph1)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular la ponderación final</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>      ponderacion_final_Dist <span class="ot">&lt;-</span> <span class="fu">sum</span>(suma_ponderada_Dist, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(totales_positivos)</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>      ponderacion_final_DistM <span class="ot">&lt;-</span> <span class="fu">sum</span>(suma_ponderada_DistM, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(totales_positivos)</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>      ponderacion_final_CF_beta0_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(suma_ponderada_CF_beta0_graph1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(totales_positivos)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>      ponderacion_final_CF_beta1_graph1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(suma_ponderada_CF_beta1_graph1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(totales_positivos)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Imprimir resultados finales</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;Resultados finales:&quot;</span>)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(ponderacion_final_Dist)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(ponderacion_final_DistM)</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(ponderacion_final_CF_beta0_graph1)</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(ponderacion_final_CF_beta1_graph1)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Almacenar los resultados finales</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>      resultados_finales <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resultados_finales, <span class="fu">data.frame</span>(<span class="at">ID1 =</span> ID1, <span class="at">ID2 =</span> ID2, <span class="at">Dist =</span> ponderacion_final_Dist, <span class="at">DistM =</span> ponderacion_final_DistM, <span class="at">CF_beta0_graph1 =</span> ponderacion_final_CF_beta0_graph1, <span class="at">CF_beta1_graph1 =</span> ponderacion_final_CF_beta1_graph1))</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Procesando IDs: E_oirensis_3924 - E_robertii_3888 
## Valor de tiempo de nodo hijo: 190 
## Valor más cercano en la columna &#39;Age&#39; para el inicio de la suma de las columnas de las duraciones en MA para cada configuración de páramo: 189.341 
## Límite hasta donde debe sumar las columnas obtenido desde matriz_limites: 480 
## Valor más cercano en la columna &#39;Age&#39; para el fin de la suma: 480.076 
## Suma de los valores de las duraciones de las configuraciones de páramo desde el inicio hasta el límite especificado en matriz_limites:
##     X1     X2     X3     X4     X5     X6     X7     X8     X9    X10    X11 
##  0.000  0.000  0.000  2.024 10.819 41.328 18.336 11.522  9.052 14.049 11.399 
##    X12    X13    X14    X15    X16    X17    X18    X19    X20    X21    X22 
## 34.416 33.324 51.091 42.030  9.486  1.859  0.000  0.000  0.000  0.000  0.000 
## Totales positivos: 2.024 10.819 41.328 18.336 11.522 9.052 14.049 11.399 34.416 33.324 51.091 42.03 9.486 1.859 
## Numeros correspondientes de los encabezados de las columnas con valores mayores que cero: 4 5 6 7 8 9 10 11 12 13 14 15 16 17 
## [1] &quot;Sumas ponderadas finales:&quot;
##  X4  X4  X5  X5  X6  X6  X7  X7  X8  X8  X9  X9 X10 X10 X11 X11 X12 X12 X13 X13 
##  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
## X14 X14 X15 X15 X16 X16 X17 X17 
##  NA  NA  NA  NA  NA  NA  NA  NA 
##  X4  X4  X5  X5  X6  X6  X7  X7  X8  X8  X9  X9 X10 X10 X11 X11 X12 X12 X13 X13 
##  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
## X14 X14 X15 X15 X16 X16 X17 X17 
##  NA  NA  NA  NA  NA  NA  NA  NA 
##  X4  X4  X5  X5  X6  X6  X7  X7  X8  X8  X9  X9 X10 X10 X11 X11 X12 X12 X13 X13 
##  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
## X14 X14 X15 X15 X16 X16 X17 X17 
##  NA  NA  NA  NA  NA  NA  NA  NA 
##  X4  X4  X5  X5  X6  X6  X7  X7  X8  X8  X9  X9 X10 X10 X11 X11 X12 X12 X13 X13 
##  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
## X14 X14 X15 X15 X16 X16 X17 X17 
##  NA  NA  NA  NA  NA  NA  NA  NA 
## [1] &quot;Resultados finales:&quot;
## [1] 0
## [1] 0
## [1] 0
## [1] 0</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar los resultados finales en un archivo CSV</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(resultados_finales, <span class="at">file =</span> <span class="st">&quot;C:/Users/Usuario/Desktop/Archivos_tesis/Resultados_finales/Resultados_finales.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
